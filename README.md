# Glacier Motion Estimation using SAR Offset Tracking for Petermann Glacier, Greenland

## 1. Introduction
Petermann Glacier is one of the largest remaining floating ice shelfs in the northern hemisphere and has been dramatically changing due to a warming climate [1]. In the past during melting season the glacier experienced an increase in velocity of around 22 %, which directly affected annual ice discharge. Therefore, information about the speed with which Petermann is moving is vital for its monitoring and to get a better understanding of underlying dynamics as well as its contribution to rising sea levels [2]. Remote sensing and especially synthetic aperture radar (SAR) data is a valuable tool to investigate and understand changes and to map areas of glacier movement. Especially, differential SAR interferometry is widely used for measuring the motion of large ice sheets and glaciers [3]. However, in case of decorrelation due to rapid and incoherent flow or large acquisition time intervals intensity offset tracking offers an alternative [4]. In this project, SAR offset tracking technique was applied to compute ice velocities of Petermann Glacier. To account for potential seasonal patterns in glacier movement, the speed was estimated once during winter in January and a second time during melting season in July for the year 2022.

## 2. Material and Methods
### 2.1 Study Area - Petermann Glacier
Petermann Glacier is a large tidewater outlet glacier located in northwestern Greenland connecting the Greenland ice sheet with the Atlantic Ocean via the Nares Strait. It is terminated by a floating ice tongue and drains through its fjord into the Hall Basin (Figure1). Petermann is considered a dynamically stable glacier with an average annual ice discharge of 11.85 Gt measured from 1986 to 2023. For the years 2016 to 2019 the average movement rate of the glacier was around 1,200 m yr-1 with an observable seasonal speedup during summer of ~22 % to around 1,500 m yr-1 [2,5].
| ![Petermann_Overview_final](https://user-images.githubusercontent.com/116877154/231275942-9294f308-7e52-4c4d-a122-0f2fd2888fd3.png) |
|:--:|
| ***Figure 1** Overview of Petermann Glacier study area and Sentinel-1A scene located in northwestern Greenland (red rectangle).* |

### 2.2 Data
| ![Sentinel1_Data](https://user-images.githubusercontent.com/116877154/231278238-a1871201-bc85-4527-8ac2-f1feda79be1e.png) |
|:--:|
| ***Figure 2** Raw Sentinel-1A ground range detected (GRD) images acquired in interferometric wide swath (IW) mode used for calculating the velocity of Petermann Glacier. Scenes (a) and (b) representing image pair 1 and (c) and (d) image pair 2 (Table1).* |

To map ice velocity and to analyze seasonality in movement, two pairs of C-band Sentinel-1A ground range detected (GRD) synthetic aperture radar images acquired in interferometric wide swath (IW) mode were downloaded from the Copernicus Open Access Hub (Figure 2) [6]. The scenes were obtained in January and July 2022 with a period of twelve days between acquisitions (Table 1). Images were acquired in HH polarization on a descending orbit (orbit 26).

 ***Table 1** Sentinel-1A image pairs from Copernicus used for SAR offset tracking.* 
| Image Pair | Acquisition Date    | Identifier                                                          |
| ---------- | ------------------- | ------------------------------------------------------------------- |
| 1          | 10.01.2022 (Master) | S1A_IW_GRDH_1SDH_20220110T113602_20220110T113627_041398_04EC1A_A7EA |
|            | 22.01.2022 (Slave)  | S1A_IW_GRDH_1SDH_20220122T113602_20220122T113627_041573_04F1D8_36FC |
| 2          | 09.07.2022 (Master) | S1A_IW_GRDH_1SDH_20220709T113607_20220709T113632_044023_054141_0B81 |
|            | 21.07.2022 (Slave)  | S1A_IW_GRDH_1SDH_20220721T113608_20220721T113633_044198_05467D_C3DF |

### 2.3 Overview Map - QGIS
Before starting the actual analysis, an overview map of the study area was created by using the QGIS software (Figure 1) [7]. The aim was to have a map showing a closeup of the study area with all important natural features as well as Petermann Glacier. Additionally, a map of Greenland highlighting the location of the study area was integrated. For the first map, a new satellite connection that served as background was loaded. In the next step, a shapefile with the extent of the study area was added. Additionally, a second file with the digitized shape of Petermann Glacier was generated by following the outlines of the glacier. After these preparations, the print layout was used to display the two maps (Figure 1). 

### 2.4 Offset Tracking - SNAP
For estimating ice velocity maps SAR offset tracking procedure was employed. The core idea of this technique is to estimate feature displacement on the glacier surface between pairs of SAR images in both slant range and azimuth direction. Intensity tracking, based on a patch intensity cross-correlation optimization algorithm relies on the use of two scenes covering the same location with a short time interval between them and the presence of nearly identical ground control points (GCP) in the pair of SAR images.

| ![Workflow](https://user-images.githubusercontent.com/116877154/231286473-e488dcad-2d15-4256-9b6a-64a4c4c6725e.png) |
|:--:|
| ***Figure 3** Workflow chart to calculate glacier velocity using SAR offset tracking technique.* |

In this study, the SNAP software provided by ESA was used for processing the data (Figure 3) [8]. Before SAR offset tracking was performed, the images were pre-processed by applying identical steps to all four scenes. First, the orbit metadata was updated by applying the orbit file. Subsequently, removal of thermal noise was performed to prevent skewed radar reflectivity due to background energy generated by the receiver. Lastly, pre-processing was concluded by calibration of the images to enable direct linkage of pixel values to radar backscatter. 
After pre-processing, the master and the slave image were co-registered with the assistance of an external DEM (ACE30). This step is necessary so that the two scenes are geometrically aligned, and corresponding pixels represent an identical area on the Earth surface. Since the scenes cover a large region, a subset of the co-registered stack only containing Petermann Glacier was created. To perform offset tracking the following steps were realized:
1. For each point on the user-specified GCP grid in the master image, corresponding pixel positions in the slave image using normalized cross-correlation were computed.
2. If the computed offset between master and slave GCP positions exceeded the maximum offset, then the GCP was marked as outlier.
3. Local average for the offset on valid GCPs was performed.
4. Holes caused by outliers were filled. The offset at a missing point was replaced by a new offset computed by local weighted average.
5. The velocities for all points on the GCP grid from their offsets were computed.
6. Computation of the velocities for all pixels in the master image from the velocities on the GCP grid by interpolation.

During those steps several parameters needed to be set. Some of them, like the maximum velocity or the registration window dimensions differ heavily between glaciers and are chosen based on literature data (Table 2).

***Table 2** Processing parameters for offset tracking. The GCP grid spacing determines the resolution of our velocity product. The size of the registration window depends on the maximum velocity of the glacier and the period between data acquisitions. The images were twelve days apart and the maximum speed of Petermann glacier is close to 5 m day-1. This means that the glacier surface will shift by maximum 60 meters and the default settings of 128 pixels are suitable.* 
|                 | Processing Parameters          |                       |
| --------------- | ------------------------------ | --------------------- |
| Output Grid     | Grid Azimuth Spacing (pixels)  | 60                    |
|                 | Grid Range Spacing (pixels)    | 60                    |
| Registration    | Window Width x Height (pixels) | 128 x 128             |
|                 | Cross-Correlation Threshold    | 0.1                   |
|                 | Max Velocity (m/ day)          | 5.0                   |
| Resampling Type |                                | Bicubic Interpolation |

Lastly, Range Doppler terrain correction was used to compensate for distortions due to the tilt of the satellite sensor, topographical variations of the scene, and to reproject the scene to geographic projection (Figure 4). 

| ![OffsetTracking_Results](https://user-images.githubusercontent.com/116877154/231562055-50ca997b-a0e2-4fa8-8bbb-a8e3df2a7af7.png) |
|:--:|
| ***Figure 4** Terrain corrected offset tracking results. The calculated velocity of the glacier was layered on top of pre-processed SAR images for (a) January and (b) July.* |

### 2.5 Visualization - QGIS
The last step was to visualize the offset tracking results. For this purpose, the results were transferred from SNAP to QGIS. First, the two velocity layers and the pre-processed slave scenes were added. Subsequently, the derived velocity values, which were stored in a .csv-file, were exported to QGIS as a delimited text layer and saved as an ESRI shapefile. The newly created velocity shapefile contained the coordinates of the GCP points in the master image, the coordinates of the corresponding point in the slave image, the distance travelled, the velocity [m day-1], the heading in degrees (East from North), the range shift, and the azimuth shift. In the following, a subset containing only a fraction (70 %) of the velocity points was created using the expression widow. This step was necessary because otherwise the point grid would have been too dense to represent the velocity vector fields. For this purpose, the “Vector field render” plugin was used. In the dialog window, the vector field type polar (length, angle) field was set, as well as velocity as length attribute and heading as angle attribute. In the print layout four maps were added. The first two maps depicted the ice flow direction in terms of the velocity vector fields and the two other maps visualized the velocity of the glacier. Maps of the same study period were horizontally aligned and maps of the same type were oriented vertically to allow visual comparison. For all maps, a pre-processed SAR slave image for the respective month was used as background. Additionally, text fields showing the study periods and a legend were added (Figure 5).
| ![PetermannVelocity_final](https://user-images.githubusercontent.com/116877154/231562647-a53d57a5-2b09-430f-ab44-f8b9c492bd02.png) |
|:--:|
| ***Figure 5** Petermann Glacier ice flux direction represented by arrows scaled with the magnitude of the velocity for January (a) and July (b). Surface velocities obtained by SAR offset tracking for January (c) and July (d). Slow acceleration on the Greenland ice sheet and rapid increase in speed along the fjord and on the ice tongue.* |

## 3. Results
The movement data of Petermann Glacier obtained by using SAR offset tracking procedure suggest that the glacier moves from its terminus in the Southeast along its fjord towards the Hall Basin in the Northwest. The velocity of the glacier follows this pattern and increases progressively downstream along its profile. Petermann gradually accelerates on the ice sheet from slow to moderate speed and experiences a rapid increase in velocity as it narrows and enters the fjord towards its front. The floating ice shelf exhibits the highest velocities which stay constant towards the front end. Additionally, a gradual deceleration towards both sides can be observed. Apart from the movement of the glacier itself, the velocity map of July depicts several outliers located on the Greenland ice sheet as well as a large amount of missing data, which limits the interpretability of the results. The comparison of the two velocity distribution diagrams reveals significant changes in the displacement rate from winter to summer. In winter the mean velocity was estimated to be around 1.507 m day-1 and during melting season in summer 2.096 m day -1. The maximum speed was found to be 3.564 and 4.198 m day-1 for January and July respectively.  

## References
1.   Polar Regions. In The Ocean and Cryosphere in a Changing Climate; Change, I.P.o.C., Ed.; Cambridge University Press, 2022; pp 164
203–320, ISBN 9781009157964
2. Lemos, A.; Shepherd, A.; McMillan, M.; Hogg, A.E.; Hatton, E.; Joughin, I. Ice velocity of Jakobshavn Isbræ, Petermann Glacier, 168
Nioghalvfjerdsfjorden, and Zachariæ Isstrøm, 2015–2017, from Sentinel 1-a/b SAR imagery. The Cryosphere 2018, 12, 2087–2097, 169
doi:10.5194/tc-12-2087-2018
3.  Joughin, I.; Kwok, R.; Fahnestock, M. Estimation of ice-sheet motion using satellite radar interferometry: method and error 171
analysis with application to Humboldt Glacier, Greenland. J. Glaciol. 1996, 42, 564–575, doi:10.3189/s0022143000003543
4. Strozzi, T.; Luckman, A.; Murray, T.; Wegmuller, U.; Werner, C.L. Glacier motion estimation using SAR offset-tracking proce- 173
dures. IEEE Trans. Geosci. Remote Sensing 2002, 40, 2384–2391, doi:10.1109/TGRS.2002.805079
5. Ehrenfeucht, S.; Morlighem, M.; Rignot, E.; Dow, C.F.; Mouginot, J. Seasonal Acceleration of Petermann Glacier, Greenland, 162
From Changes in Subglacial Hydrology. Geophysical Research Letters 2023, 50, doi:10.1029/2022GL098009
6. Copernicus. Sentinel-1 Images. Available online: https://scihub.copernicus.eu/dhus/#/home
7. QGIS Development Team, 2022. QGIS Geographic Information System. Open Source Geospatial Foundation Project. http://qgis.osgeo.org
8. SNAP; ESA Sentinel Application Platform.
